---
title: relax by examples
author: gaoyantao
date: 2023-12-22
category: examples
layout: post
---

## 1. what is polaron

Polaron is a quasiparticle composed of an electron and an effective polarization field that it creates in its surrounding. It can be either a charged or a neutral entity, depending on the balance between the electron's kinetic energy and the energy of its polarization field. The polaron concept was first proposed by Lev Landau and Solomon Pekar in 1948 as a description of electrons in ionic crystals and polar semiconductors. The polaron model has been very successful in describing the properties of many defects and impurities in insulating crystals and polar semiconductors. It has also been used to describe electrons and holes in doped semiconductors (see Semiconductor doping) and the effects of ionizing radiation on the properties of semiconductors. The polaron model is also applicable to electrons moving through certain types of liquids and molecular solids, such as liquid helium and molecular crystals, and to electrons moving through certain types of polymers and biological molecules.

## 2. what is relax

Relax is a program for the study of the dynamics of proteins and other macromolecules though the analysis of experimental NMR data. It supports exponential curve fitting for the calculation of the R1 and R2 relaxation rates, calculation of the NOE, reduced spectral density mapping, the Lipari and Szabo model-free analysis, study of domain motions via the N-state model (or ensemble analysis) and frame order dynamics theories using anisotropic NMR parameters such as RDCs and PCSs, the investigation of stereochemistry in dynamic ensembles, and the analysis of relaxation dispersion data.

## 3. how to do relax in PWmat

prepare the structure file atom.config:
    
```
         111
Lattice vector
      9.5904281180      0.0000000000      0.0000000000
      0.0000000000     12.3831483920      0.0000000000
      0.0000000000      0.0000000000     10.6284269400
Position, move_x, move_y, move_z
   3    0.000000000000    0.000000000000    0.500000000000   1   1   1
   3    0.250000000000    0.000000000000    0.000000000000   1   1   1
   3    0.250000000000    0.250000000000    0.000000000000   1   1   1
   3    0.000000000000    0.250000000000    0.500000000000   1   1   1
   3    0.000000000000    0.500000000000    0.500000000000   1   1   1
   3    0.250000000000    0.500000000000    0.000000000000   1   1   1
   3    0.250000000000    0.750000000000    0.000000000000   1   1   1
   3    0.000000000000    0.750000000000    0.500000000000   1   1   1
   3    0.500000000000    0.000000000000    0.500000000000   1   1   1
   3    0.750000000000    0.000000000000    0.000000000000   1   1   1
   3    0.750000000000    0.250000000000    0.000000000000   1   1   1
   3    0.500000000000    0.250000000000    0.500000000000   1   1   1
   3    0.750000000000    0.500000000000    0.000000000000   1   1   1
   3    0.750000000000    0.750000000000    0.000000000000   1   1   1
   3    0.500000000000    0.750000000000    0.500000000000   1   1   1
  25    0.014621109500    0.375000000000    0.781548631001   1   1   1
  25    0.485378890500    0.125000000000    0.218451369000   1   1   1
  25    0.264621109500    0.125000000000    0.718451369000   1   1   1
  25    0.235378890500    0.375000000000    0.281548631000   1   1   1
  25    0.014621109500    0.875000000000    0.781548631001   1   1   1
  25    0.485378890500    0.625000000000    0.218451369000   1   1   1
  25    0.264621109500    0.625000000000    0.718451369000   1   1   1
  25    0.235378890500    0.875000000000    0.281548631000   1   1   1
  25    0.514621109500    0.375000000000    0.781548631001   1   1   1
  25    0.985378890500    0.125000000000    0.218451369000   1   1   1
  25    0.764621109500    0.125000000000    0.718451369000   1   1   1
  25    0.735378890500    0.375000000000    0.281548631000   1   1   1
  25    0.514621109500    0.875000000000    0.781548631001   1   1   1
  25    0.985378890500    0.625000000000    0.218451369000   1   1   1
  25    0.764621109500    0.625000000000    0.718451369000   1   1   1
  25    0.735378890500    0.875000000000    0.281548631000   1   1   1
  15    0.046554370500    0.125000000000    0.908805288001   1   1   1
  15    0.453445629500    0.375000000000    0.091194712000   1   1   1
  15    0.296554370500    0.375000000000    0.591194712000   1   1   1
  15    0.203445629500    0.125000000000    0.408805288000   1   1   1
  15    0.046554370500    0.625000000000    0.908805288001   1   1   1
  15    0.453445629500    0.875000000000    0.091194712000   1   1   1
  15    0.296554370500    0.875000000000    0.591194712000   1   1   1
  15    0.203445629500    0.625000000000    0.408805288000   1   1   1
  15    0.546554370500    0.125000000000    0.908805288001   1   1   1
  15    0.953445629500    0.375000000000    0.091194712000   1   1   1
  15    0.796554370500    0.375000000000    0.591194712000   1   1   1
  15    0.703445629500    0.125000000000    0.408805288000   1   1   1
  15    0.546554370500    0.625000000000    0.908805288001   1   1   1
  15    0.953445629500    0.875000000000    0.091194712000   1   1   1
  15    0.796554370500    0.875000000000    0.591194712000   1   1   1
  15    0.703445629500    0.625000000000    0.408805288000   1   1   1
   8    0.112854604500    0.025057067000    0.840354375000   1   1   1
   8    0.107117645500    0.125000000000    0.044388233000   1   1   1
   8    0.113332657500    0.375000000000    0.095700855000   1   1   1
   8    0.387145395500    0.474942933000    0.159645625000   1   1   1
   8    0.392882354500    0.375000000000    0.955611767000   1   1   1
   8    0.386667342500    0.125000000000    0.904299145000   1   1   1
   8    0.362854604500    0.474942933000    0.659645625000   1   1   1
   8    0.357117645500    0.375000000000    0.455611767000   1   1   1
   8    0.363332657500    0.125000000000    0.404299145000   1   1   1
   8    0.137145395500    0.025057067000    0.340354375000   1   1   1
   8    0.142882354500    0.125000000000    0.544388233001   1   1   1
   8    0.136667342500    0.375000000000    0.595700855000   1   1   1
   8    0.137145395500    0.224942933000    0.340354375000   1   1   1
   8    0.362854604500    0.275057067000    0.659645625000   1   1   1
   8    0.387145395500    0.275057067000    0.159645625000   1   1   1
   8    0.112854604500    0.224942933000    0.840354375000   1   1   1
   8    0.112854604500    0.525057067000    0.840354375000   1   1   1
   8    0.107117645500    0.625000000000    0.044388233000   1   1   1
   8    0.113332657500    0.875000000000    0.095700855000   1   1   1
   8    0.387145395500    0.974942933000    0.159645625000   1   1   1
   8    0.392882354500    0.875000000000    0.955611767000   1   1   1
   8    0.386667342500    0.625000000000    0.904299145000   1   1   1
   8    0.362854604500    0.974942933000    0.659645625000   1   1   1
   8    0.357117645500    0.875000000000    0.455611767000   1   1   1
   8    0.363332657500    0.625000000000    0.404299145000   1   1   1
   8    0.137145395500    0.525057067000    0.340354375000   1   1   1
   8    0.142882354500    0.625000000000    0.544388233001   1   1   1
   8    0.136667342500    0.875000000000    0.595700855000   1   1   1
   8    0.137145395500    0.724942933001    0.340354375000   1   1   1
   8    0.362854604500    0.775057067000    0.659645625000   1   1   1
   8    0.387145395500    0.775057067000    0.159645625000   1   1   1
   8    0.112854604500    0.724942933001    0.840354375000   1   1   1
   8    0.612854604500    0.025057067000    0.840354375000   1   1   1
   8    0.607117645500    0.125000000000    0.044388233000   1   1   1
   8    0.613332657500    0.375000000000    0.095700855000   1   1   1
   8    0.887145395500    0.474942933000    0.159645625000   1   1   1
   8    0.892882354500    0.375000000000    0.955611767000   1   1   1
   8    0.886667342500    0.125000000000    0.904299145000   1   1   1
   8    0.862854604500    0.474942933000    0.659645625000   1   1   1
   8    0.857117645500    0.375000000000    0.455611767000   1   1   1
   8    0.863332657500    0.125000000000    0.404299145000   1   1   1
   8    0.637145395500    0.025057067000    0.340354375000   1   1   1
   8    0.642882354500    0.125000000000    0.544388233001   1   1   1
   8    0.636667342500    0.375000000000    0.595700855000   1   1   1
   8    0.637145395500    0.224942933000    0.340354375000   1   1   1
   8    0.862854604500    0.275057067000    0.659645625000   1   1   1
   8    0.887145395500    0.275057067000    0.159645625000   1   1   1
   8    0.612854604500    0.224942933000    0.840354375000   1   1   1
   8    0.612854604500    0.525057067000    0.840354375000   1   1   1
   8    0.607117645500    0.625000000000    0.044388233000   1   1   1
   8    0.613332657500    0.875000000000    0.095700855000   1   1   1
   8    0.887145395500    0.974942933000    0.159645625000   1   1   1
   8    0.892882354500    0.875000000000    0.955611767000   1   1   1
   8    0.886667342500    0.625000000000    0.904299145000   1   1   1
   8    0.862854604500    0.974942933000    0.659645625000   1   1   1
   8    0.857117645500    0.875000000000    0.455611767000   1   1   1
   8    0.863332657500    0.625000000000    0.404299145000   1   1   1
   8    0.637145395500    0.525057067000    0.340354375000   1   1   1
   8    0.642882354500    0.625000000000    0.544388233001   1   1   1
   8    0.636667342500    0.875000000000    0.595700855000   1   1   1
   8    0.637145395500    0.724942933001    0.340354375000   1   1   1
   8    0.862854604500    0.775057067000    0.659645625000   1   1   1
   8    0.887145395500    0.775057067000    0.159645625000   1   1   1
   8    0.612854604500    0.724942933001    0.840354375000   1   1   1
MAGNETIC
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
   3    0.000000000000
  25    5.000000000000
  25    5.000000000000
  25   -5.000000000000
  25   -4.000000000000
  25    5.000000000000
  25    5.000000000000
  25   -5.000000000000
  25   -5.000000000000
  25    5.000000000000
  25    5.000000000000
  25   -5.000000000000
  25   -5.000000000000
  25    5.000000000000
  25    5.000000000000
  25   -5.000000000000
  25   -5.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
  15    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
   8    0.000000000000
```
prepare the input file etot.input:
    
```
4 4 

JOB          = relax
IN.ATOM      = atom.config 
IN.PSP1      = Li.SG15.PBE.UPF 
IN.PSP2      = Mn.SG15.PBE.UPF 
IN.PSP3      = P.SG15.PBE.UPF 
IN.PSP4      = O.SG15.PBE.UPF 

RELAX_DETAIL = 1 1000 0.003
ECUT         = 50 
ECUT2        = 200
MP_N123       = 3 2 2 0 0 0 2 
XCFUNCTIONAL = PBE 

E_ERROR = 0.0
RHO_ERROR = 1E-5
OUT.FORCE = T

SPIN = 2
LDAU_PSP2 = 2 4.0
LDAU_RCUT_PSP2 = 4.00000000000000

SCF_ITER0_1 =      6        4    3    0.0000     0.025000    2
SCF_ITER0_2 =     20        4    3    1.0000     0.025000    2
SCF_ITER1_1 =     20        4    3    1.0000     0.025000    2

```

run the relax program:
    
```
mpi -np 16 PWmat | tee output
```

## 4. tips for polaron relax
1. use e\_error = 0.0, the energy covergence is not stable, use the rho\_error to control the convergence of SCF.

2. use Ecut2=4*Ecut, the force will be more accurate.

3. use small scf steps, for example, SCF\_ITER0\_1 = 6 4 3 0.0000 0.025000 2, SCF\_ITER0\_2 = 20 4 3 1.0000 0.025000 2, SCF\_ITER1\_1 = 20 4 3 1.0000 0.025000 2. The very first steps SCF may not converge well, so we just use small steps to get rough force, the forces in the following steps will be more accurate.

4. use smaller fermi smearing, for example, 0.025000, the occupation number will be more accurate. also can use different smearing method, for example, gaussian smearing.

5. use smaller force tolerance, for example, 0.005 to avoid the wrong stop of relax.

6. use sufficient kpoints.

7. do not use the symmetry for polarons.

8. try to relax multiple times, use the last structure as the input structure for the next relax, each time with smaller force tolerance and smaller fermi smearing. you can use OUT.RHO, OUT.LDAU to improve the convergence of SCF in your continuse relax.

9. use proper settting of magnetization.


insert a picture:

|SPIN UP-DN| T*S| Total Energy|
|:---:|:---:|:---:|
|![mag](/assets/jekyll-gitbook/mag.png)|![ts](/assets/jekyll-gitbook/ts.png)|![etot](/assets/jekyll-gitbook/etot.png)|

